<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favcon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#6366f1" />
    <meta name="description" content="VRChatでのキャスト募集・参加者募集を効率的に行えるプラットフォーム。写真撮影、動画制作、イベント開催などの企画に最適なキャストを見つけよう。" />
    <meta name="keywords" content="VRChat, キャスト募集, VR, バーチャル, 写真撮影, 動画制作, イベント, 募集, 参加者" />
    <meta name="author" content="castChat" />
    <meta name="robots" content="index, follow" />
    <link rel="manifest" href="/manifest.webmanifest" />
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600&display=swap" rel="stylesheet">
    <title>castChat - VRChatキャスト募集</title>
  </head>
  <body>
    <div id="app">
      <!-- フォールバックメッセージ -->
      <div
        id="fallback"
        style="display: none; text-align: center; padding: 2rem; font-family: system-ui, sans-serif"
      >
        <h1>castChat</h1>
        <p>アプリケーションの読み込み中にエラーが発生しました。</p>
        <p>ページを再読み込みしてください。</p>
        <button
          onclick="window.location.reload()"
          style="
            padding: 0.5rem 1rem;
            background: #6366f1;
            color: white;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
          "
        >
          再読み込み
        </button>
      </div>
    </div>
    <script type="module" src="/src/main.ts"></script>
    <script>
      // グローバルエラーハンドリング
      window.addEventListener('error', function (event) {
        console.error('Global error:', {
          message: event.message,
          filename: event.filename,
          lineno: event.lineno,
          colno: event.colno,
          error: event.error,
          stack: event.error?.stack
        })
        
        // エラー詳細を表示
        const fallback = document.getElementById('fallback')
        const errorInfo = document.createElement('div')
        errorInfo.style.cssText = 'margin-top: 1rem; padding: 1rem; background: #fee2e2; border-radius: 0.375rem; text-align: left; font-size: 0.875rem; color: #dc2626;'
        errorInfo.innerHTML = `
          <strong>エラー詳細:</strong><br>
          ファイル: ${event.filename}<br>
          行: ${event.lineno}:${event.colno}<br>
          メッセージ: ${event.message}<br>
          ${event.error?.stack ? `<br><strong>スタック:</strong><br><pre style="white-space: pre-wrap; font-size: 0.75rem;">${event.error.stack}</pre>` : ''}
        `
        fallback.appendChild(errorInfo)
        fallback.style.display = 'block'
      })

      window.addEventListener('unhandledrejection', function (event) {
        console.error('Unhandled promise rejection:', event.reason)
        
        const fallback = document.getElementById('fallback')
        const errorInfo = document.createElement('div')
        errorInfo.style.cssText = 'margin-top: 1rem; padding: 1rem; background: #fef3c7; border-radius: 0.375rem; text-align: left; font-size: 0.875rem; color: #d97706;'
        errorInfo.innerHTML = `
          <strong>Promise エラー:</strong><br>
          ${event.reason?.message || event.reason || 'Unknown promise rejection'}<br>
          ${event.reason?.stack ? `<br><strong>スタック:</strong><br><pre style="white-space: pre-wrap; font-size: 0.75rem;">${event.reason.stack}</pre>` : ''}
        `
        fallback.appendChild(errorInfo)
        fallback.style.display = 'block'
      })
    </script>
  </body>
</html>
