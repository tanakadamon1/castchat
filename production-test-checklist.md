# コイン購入システム 本番環境テスト チェックリスト

## 事前確認 ✅
- [x] Square本番環境設定完了
- [x] Supabase Edge Function環境変数設定完了
- [x] ビルド成功確認
- [x] 特定商取引法対応ページ更新完了

## テスト実施手順

### 1. 基本動作確認
- [ ] アプリケーションの起動
- [ ] ユーザーログイン
- [ ] コイン購入画面へのアクセス
- [ ] Square決済フォームの表示確認

### 2. 決済機能テスト
- [ ] 1コイン（100円）の購入テスト
- [ ] 決済処理の完了確認
- [ ] コイン残高の更新確認
- [ ] 取引履歴の記録確認

### 3. エラーハンドリングテスト
- [ ] 無効なカード情報での決済テスト
- [ ] ネットワークエラーのシミュレーション
- [ ] 自動返金機能のテスト（可能であれば）

### 4. UI/UXテスト
- [ ] 決済フォームの見た目確認
- [ ] エラーメッセージの表示確認
- [ ] 成功メッセージの表示確認
- [ ] レスポンシブデザインの確認

## 確認すべきログ

### Supabase Edge Function ログ
```bash
# コマンド例
supabase functions logs square-payment --follow
```

### 確認すべきログ項目
- [ ] Square API接続成功
- [ ] 決済処理開始
- [ ] 決済処理完了
- [ ] データベース更新成功
- [ ] エラー発生時の詳細ログ

## 実際の決済テスト

### テスト環境
- **決済環境**: Production
- **テスト金額**: 100円（1コイン）
- **使用カード**: 実際のクレジットカード

### テスト記録
| 項目 | 結果 | 備考 |
|------|------|------|
| 決済フォーム表示 | ⭕/❌ | |
| 決済処理成功 | ⭕/❌ | |
| コイン残高更新 | ⭕/❌ | |
| 取引履歴記録 | ⭕/❌ | |
| レシート表示 | ⭕/❌ | |

## エラーテスト記録
| エラー種類 | 期待する動作 | 実際の動作 | 結果 |
|-----------|-------------|-----------|------|
| 無効カード | エラーメッセージ表示 | | ⭕/❌ |
| ネットワークエラー | リトライ・エラー表示 | | ⭕/❌ |
| DB更新失敗 | 自動返金処理 | | ⭕/❌ |

## 本番環境特有の確認事項

### セキュリティ確認
- [ ] HTTPS接続の確認
- [ ] カード情報の暗号化確認
- [ ] 決済データの適切な処理

### パフォーマンス確認
- [ ] 決済処理時間の測定
- [ ] UI応答性の確認
- [ ] エラー発生時の処理時間

### 法的対応確認
- [ ] 特定商取引法ページの表示確認
- [ ] 返金規定の明記確認
- [ ] 決済完了通知の内容確認

## 最終確認

### 本番運用前チェック
- [ ] すべてのテストが合格
- [ ] エラーハンドリングが適切
- [ ] ログ監視体制の確認
- [ ] サポート体制の確認

## 問題発生時の対応

### 緊急時連絡先
- システム管理者: [連絡先]
- Square サポート: [連絡先]
- Supabase サポート: [連絡先]

### 緊急時対応手順
1. 決済機能の一時停止
2. 問題の調査と修正
3. 修正後の再テスト
4. 機能の再有効化

## 記録者
- テスト実施者: 
- テスト実施日: 
- 承認者: 
- 承認日: 